---
import siteData from "../../site.json";
import WhatsApp from "./icons/WhatsApp.astro";
import IconMenu from "./icons/IconMenu.astro";
import IconClose from "./icons/IconClose.astro";

interface MenuItem {
  name: string;
  link: string;
}

interface NavData {
  menu: MenuItem[];
  button1: {
    text: string;
    link: string;
  };
}

const navData: NavData = siteData.navd;
---

<nav
  class="h-[70px] w-full border-b border-gray-300 fixed top-0 left-0 bg-white z-[9999] shadow-sm"
>
  <div
    class="max-w-[1200px] w-full h-full px-6 box-border mx-auto flex items-center justify-between"
  >
    <div class="logo flex items-center gap-4">
      <a href="/" class="flex items-center">
        <img
          src="/images/logoFirmeasy-nfc.webp"
          alt="logo firmaeasy"
          width="131"
          height="36"
          class="h-9"
        />
      </a>
      <a href="/repository" class="pl-4 border-l border-gray-300">
        <img
          src="/images/verifiedSunat-nfc.svg"
          alt="verificado firmeasy"
          class="h-6"
        />
      </a>
    </div>
    <input type="checkbox" id="menu" class="hidden" />
    <div class="flex items-center gap-8 h-full text-sm font-medium">
      <ul class="menu-list list-none flex items-center h-full gap-8 m-0 p-0">
        {
          navData.menu.map((item: MenuItem) => (
            <li>
              <a
                href={item.link}
                class="menu-link text-gray-700 no-underline transition-colors duration-200 hover:text-green-600 text-[14.4px]"
              >
                {item.name}
              </a>
            </li>
          ))
        }
      </ul>
      <div class="actions-container flex items-center gap-4">
        <a
          href={navData.button1.link}
          target="_blank"
          class="px-6 py-3 rounded-xl no-underline font-semibold transition-all duration-200 inline-flex items-center gap-2 bg-gradient-to-r from-[#00a280] via-[#01a182] to-[#4646a7] text-white shadow-lg shadow-[#00a280]/30 hover:from-[#007a6b] hover:via-[#016f72] hover:to-[#3a3d8f] hover:-translate-y-0.5 hover:shadow-lg hover:shadow-[#00a280]/40"
        >
          <WhatsApp />
          {navData.button1.text}
        </a>
      </div>
      <label for="menu" class="menu-toggle hidden cursor-pointer">
        <i class="menu-icon-hamburger">
          <IconMenu />
        </i>
        <i class="menu-icon-close hidden">
          <IconClose />
        </i>
      </label>
    </div>
  </div>
</nav>

<style>
  /* Responsive logo for mobile */
  @media (max-width: 768px) {
    .logo {
      flex-direction: column;
      align-items: flex-start;
      gap: 4px;
    }

    .logo a:last-child {
      border-left: 0;
      padding-left: 0;
      margin-top: -4px;
    }

    .logo a:last-child img {
      height: 16px;
    }
  }

  /* Menu hamburguesa responsive */
  @media (max-width: 1024px) {
    .menu-list {
      position: absolute;
      top: 100%;
      left: 0;
      width: 100%;
      height: auto;
      z-index: 99999;
      background-color: white;
      border: 1px solid #e5e7eb;
      padding: 24px;
      flex-direction: column;
      align-items: flex-start;
      gap: 16px;
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.2);
      display: none;
      box-sizing: border-box;
    }

    .menu-toggle {
      display: block;
    }

    .menu-toggle .menu-icon-hamburger {
      display: block;
    }

    .menu-toggle .menu-icon-close {
      display: none;
    }

    /* Cuando el menú está abierto */
    #menu:checked ~ div .menu-list {
      display: flex;
    }

    #menu:checked ~ div .menu-toggle .menu-icon-hamburger {
      display: none;
    }

    #menu:checked ~ div .menu-toggle .menu-icon-close {
      display: block;
    }
  }

  /* Actions responsive */
  @media (max-width: 640px) {
    .actions-container {
      gap: 8px;
    }
  }

  @media (max-width: 475px) {
    .actions-container {
      display: none;
    }
  }

  /* Iconos SVG */
  .menu-toggle i svg {
    width: 24px;
    height: 24px;
    color: #374151;
  }

  /* Compensar la altura del navbar fijo */
  body {
    padding-top: 70px;
  }

  /* Para elementos con posición sticky */
  main,
  section {
    position: relative;
    z-index: 1;
  }
</style>

<script>
  // Función para cerrar el menú hamburguesa
  function closeMenu() {
    const menuCheckbox = document.getElementById("menu") as HTMLInputElement;
    if (menuCheckbox) {
      menuCheckbox.checked = false;
    }
  }

  // Agregar event listeners cuando el DOM esté cargado
  document.addEventListener("DOMContentLoaded", () => {
    // Seleccionar todos los enlaces del menú
    const menuLinks = document.querySelectorAll(".menu-link");

    // Agregar event listener a cada enlace del menú
    menuLinks.forEach((link) => {
      link.addEventListener("click", () => {
        // Cerrar el menú cuando se hace clic en un enlace
        closeMenu();
      });
    });
  });
</script>
